<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }} - {{ session.get('business_name', 'Business Dashboard') }}</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Base styles from Tailwind's preflight and your custom styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f7f6;
            color: #333;
            margin: 0;
            padding: 0;
            line-height: 1.5;
        }

        /* Replicating Tailwind's utility classes with standard CSS */
        .min-h-screen { min-height: 100vh; }
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 2rem;
        }
        .py-8 { padding-top: 2rem; padding-bottom: 2rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
        .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        .py-8 { padding-top: 2rem; padding-bottom: 2rem; }
        .mr-2 { margin-right: 0.5rem; }

        /* Flexbox and layout styles */
        .flex { display: flex; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .block { display: block; }
        .w-full { width: 100%; }

        /* Typography */
        .text-3xl { font-size: 1.875rem; line-height: 2.25rem; }
        .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
        .text-gray-800 { color: #1f2937; }
        .text-gray-700 { color: #374151; }
        .text-gray-600 { color: #4b5563; }
        .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
        .font-bold { font-weight: 700; }
        .font-semibold { font-weight: 600; }
        .font-medium { font-weight: 500; }
        .leading-tight { line-height: 1.25; }

        /* Card and button styles */
        .card {
            background-color: #ffffff;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 2rem;
        }
        .btn {
            padding: 0.6rem 1.2rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.2s ease-in-out;
            border: 1px solid transparent;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
        }
        .btn-primary {
            background-color: #10B981; /* Emerald 500 */
            color: white;
        }
        .btn-primary:hover {
            background-color: #059669; /* Emerald 600 */
        }
        .btn-secondary {
            background-color: #6B7280; /* Gray 500 */
            color: white;
        }
        .btn-secondary:hover {
            background-color: #4B5563; /* Gray 600 */
        }

        /* Form elements */
        .shadow { box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); }
        .appearance-none { -webkit-appearance: none; -moz-appearance: none; appearance: none; }
        .border { border-width: 1px; border-style: solid; border-color: #d1d5db; }
        .rounded { border-radius: 0.25rem; }
        .focus\:outline-none:focus { outline: 2px solid transparent; outline-offset: 2px; }
        .focus\:shadow-outline:focus { box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.5); }

        /* Flash message styles */
        .flash-message {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
        }
        .flash-message i { margin-right: 0.75rem; }
        .flash-success {
            background-color: #D1FAE5; color: #065F46; border: 1px solid #34D399;
        }
        .flash-danger {
            background-color: #FEE2E2; color: #991B1B; border: 1px solid #F87171;
        }
        .flash-warning {
            background-color: #FFFBEB; color: #92400E; border: 1px solid #FCD34D;
        }
        .flash-info {
            background-color: #DBEAFE; color: #1E40AF; border: 1px solid #60A5FA;
        }

        /* SVG icon styles */
        .w-5 { width: 1.25rem; }
        .h-5 { height: 1.25rem; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container py-8">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="mb-6">
                    {% for category, message in messages %}
                        <div class="flash-message flash-{{ category }}">
                            {# No Font Awesome, so we'll use a simple text or a different icon solution #}
                            {% if category == 'success' %}&#10004;{% elif category == 'danger' %}&#10006;{% elif category == 'warning' %}!{% else %}i{% endif %}
                            {{ message }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        <div class="flex justify-between items-center mb-6">
            <h1 class="text-3xl font-bold text-gray-800">{{ title }}</h1>
            <a href="{{ url_for('manage_business_users') }}" class="btn btn-secondary flex items-center">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                Back to User List
            </a>
        </div>

        <div class="card">
            <form action="" method="POST">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <div class="mb-4">
                    <label for="username" class="block text-gray-700 text-sm font-semibold mb-2">Username:</label>
                    <input type="text" id="username" name="username" value="{{ user.username if user else '' }}"
                           class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                </div>

                <div class="mb-4">
                    <label for="password" class="block text-gray-700 text-sm font-semibold mb-2">Password:</label>
                    <input type="password" id="password" name="password" value="{{ user.password if user else '' }}"
                           class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                </div>

                <div class="mb-6">
                    <label for="role" class="block text-gray-700 text-sm font-semibold mb-2">Role:</label>
                    <select id="role" name="role"
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        {% if user_role == 'admin' %}
                            <option value="admin" {% if user and user.role == 'admin' %} selected {% endif %}>Admin</option>
                        {% endif %}
                        <option value="sales" {% if user and user.role == 'sales' %} selected {% endif %}>Sales</option>
                        <option value="viewer" {% if user and user.role == 'viewer' %} selected {% endif %}>Viewer</option>
                    </select>
                </div>

                <div class="flex items-center justify-between">
                    <button type="submit" class="btn btn-primary">
                        {{ 'Add User' if not user else 'Update User' }}
                    </button>
                </div>
            </form>
        </div>
    </div>
</body>
</html>